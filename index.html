<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
  <title>Generative Art Gallery</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.7.0/p5.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles/reset.css">
  <link rel="stylesheet" href="styles/main.css">
  <link rel="stylesheet" href="styles/components.css">
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            'sans': ['Inter', 'system-ui', 'sans-serif'],
            'mono': ['JetBrains Mono', 'monospace'],
          },
          animation: {
            'fade-in': 'fadeIn 0.6s ease-in-out',
            'slide-up': 'slideUp 0.4s ease-out',
            'scale-in': 'scaleIn 0.3s ease-out',
            'float': 'float 6s ease-in-out infinite',
            'glow': 'glow 2s ease-in-out infinite alternate',
          },
          keyframes: {
            fadeIn: {
              '0%': { opacity: '0', transform: 'translateY(20px)' },
              '100%': { opacity: '1', transform: 'translateY(0)' },
            },
            slideUp: {
              '0%': { transform: 'translateY(10px)', opacity: '0' },
              '100%': { transform: 'translateY(0)', opacity: '1' },
            },
            scaleIn: {
              '0%': { transform: 'scale(0.95)', opacity: '0' },
              '100%': { transform: 'scale(1)', opacity: '1' },
            },
            float: {
              '0%, 100%': { transform: 'translateY(0px)' },
              '50%': { transform: 'translateY(-10px)' },
            },
            glow: {
              '0%': { boxShadow: '0 0 20px rgba(59, 130, 246, 0.3)' },
              '100%': { boxShadow: '0 0 30px rgba(59, 130, 246, 0.6)' },
            },
          },
          backdropBlur: {
            'xs': '2px',
          },
        }
      }
    }
  </script>
</head>
<body class="bg-gradient-to-br from-gray-50 via-blue-50 to-purple-50 dark:from-gray-900 dark:via-blue-900 dark:to-purple-900 transition-all duration-500 min-h-screen overflow-x-hidden" style="min-height: 100dvh;">
  <div class="main-container">
    <header class="header">
      <div class="header-card">
        <h1 class="main-title">Generative Art Gallery</h1>
        <div class="header-badges">
          <span class="badge badge-blue">p5.js</span>
          <span class="badge badge-purple">Mathematics</span>
          <span class="badge badge-pink">Interactive</span>
          <button onclick="toggleDarkMode()" class="dark-mode-toggle">
            <svg class="w-4 h-4 text-gray-800 dark:text-gray-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path class="dark:hidden" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
              <path class="hidden dark:block" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
            </svg>
          </button>
        </div>
      </div>
    </header>

    <!-- 3-Column Layout -->
    <div class="three-column-layout">
      <!-- Left Column: Art Selection -->
      <div class="left-sidebar">
        <h2 class="sidebar-title">作品選択</h2>
        <div class="button-grid-3x3">
          <button onclick="loadSketch('flow_field')" class="art-button emerald">
            <div class="art-button-bg"></div>
            <div class="art-button-decoration"></div>
            <div class="art-button-content">
              <h3 class="art-button-title">Flow Field Particles</h3>
              <p class="art-button-desc">ノイズベースの流れ場に沿って動くパーティクル</p>
              <div class="art-button-indicator">
                <span class="indicator-dot"></span>
                <span class="indicator-text">Interactive</span>
              </div>
            </div>
          </button>

      <button onclick="loadSketch('wave_interference')" class="group relative overflow-hidden rounded-2xl bg-white/70 dark:bg-gray-800/70 backdrop-blur-md shadow-lg hover:shadow-2xl transition-all duration-500 p-3 sm:p-4 border border-purple-200/50 dark:border-purple-700/50 hover:border-purple-400 dark:hover:border-purple-500 hover:scale-105 transform min-h-[100px]">
        <div class="absolute inset-0 bg-gradient-to-br from-purple-400 to-pink-500 opacity-0 group-hover:opacity-20 transition-all duration-500"></div>
        <div class="absolute -top-10 -right-10 w-20 h-20 bg-purple-400 rounded-full opacity-10 group-hover:opacity-20 group-hover:scale-110 transition-all duration-500"></div>
        <div class="relative z-10">
          <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100 mb-2 group-hover:text-purple-600 dark:group-hover:text-purple-400 transition-colors">Wave Interference</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm leading-relaxed">複数の波源からの干渉パターン</p>
          <div class="mt-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
            <span class="inline-block w-2 h-2 bg-purple-400 rounded-full animate-pulse"></span>
            <span class="text-xs text-purple-600 dark:text-purple-400 ml-2 font-mono">Interactive</span>
          </div>
        </div>
      </button>

      <button onclick="loadSketch('recursive_tree')" class="group relative overflow-hidden rounded-2xl bg-white/70 dark:bg-gray-800/70 backdrop-blur-md shadow-lg hover:shadow-2xl transition-all duration-500 p-3 sm:p-4 border border-amber-200/50 dark:border-amber-700/50 hover:border-amber-400 dark:hover:border-amber-500 hover:scale-105 transform min-h-[100px]">
        <div class="absolute inset-0 bg-gradient-to-br from-amber-400 to-orange-500 opacity-0 group-hover:opacity-20 transition-all duration-500"></div>
        <div class="absolute -top-10 -right-10 w-20 h-20 bg-amber-400 rounded-full opacity-10 group-hover:opacity-20 group-hover:scale-110 transition-all duration-500"></div>
        <div class="relative z-10">
          <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100 mb-2 group-hover:text-amber-600 dark:group-hover:text-amber-400 transition-colors">Recursive Tree</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm leading-relaxed">風に揺れるフラクタルツリー</p>
          <div class="mt-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
            <span class="inline-block w-2 h-2 bg-amber-400 rounded-full animate-pulse"></span>
            <span class="text-xs text-amber-600 dark:text-amber-400 ml-2 font-mono">Interactive</span>
          </div>
        </div>
      </button>

      <button onclick="loadSketch('harmonic_waves')" class="group relative overflow-hidden rounded-2xl bg-white/70 dark:bg-gray-800/70 backdrop-blur-md shadow-lg hover:shadow-2xl transition-all duration-500 p-3 sm:p-4 border border-cyan-200/50 dark:border-cyan-700/50 hover:border-cyan-400 dark:hover:border-cyan-500 hover:scale-105 transform min-h-[100px]">
        <div class="absolute inset-0 bg-gradient-to-br from-cyan-400 to-blue-500 opacity-0 group-hover:opacity-20 transition-all duration-500"></div>
        <div class="absolute -top-10 -right-10 w-20 h-20 bg-cyan-400 rounded-full opacity-10 group-hover:opacity-20 group-hover:scale-110 transition-all duration-500"></div>
        <div class="relative z-10">
          <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100 mb-2 group-hover:text-cyan-600 dark:group-hover:text-cyan-400 transition-colors">Harmonic Waves</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm leading-relaxed">正弦波と余弦波の美しい調和</p>
          <div class="mt-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
            <span class="inline-block w-2 h-2 bg-cyan-400 rounded-full animate-pulse"></span>
            <span class="text-xs text-cyan-600 dark:text-cyan-400 ml-2 font-mono">Interactive</span>
          </div>
        </div>
      </button>

      <button onclick="loadSketch('polar_rose')" class="group relative overflow-hidden rounded-2xl bg-white/70 dark:bg-gray-800/70 backdrop-blur-md shadow-lg hover:shadow-2xl transition-all duration-500 p-3 sm:p-4 border border-pink-200/50 dark:border-pink-700/50 hover:border-pink-400 dark:hover:border-pink-500 hover:scale-105 transform min-h-[100px]">
        <div class="absolute inset-0 bg-gradient-to-br from-pink-400 to-rose-500 opacity-0 group-hover:opacity-20 transition-all duration-500"></div>
        <div class="absolute -top-10 -right-10 w-20 h-20 bg-pink-400 rounded-full opacity-10 group-hover:opacity-20 group-hover:scale-110 transition-all duration-500"></div>
        <div class="relative z-10">
          <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100 mb-2 group-hover:text-pink-600 dark:group-hover:text-pink-400 transition-colors">Polar Rose</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm leading-relaxed">極座標バラ曲線の幾何学模様</p>
          <div class="mt-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
            <span class="inline-block w-2 h-2 bg-pink-400 rounded-full animate-pulse"></span>
            <span class="text-xs text-pink-600 dark:text-pink-400 ml-2 font-mono">Interactive</span>
          </div>
        </div>
      </button>

      <button onclick="loadSketch('noise_field_sculpture')" class="group relative overflow-hidden rounded-2xl bg-white/70 dark:bg-gray-800/70 backdrop-blur-md shadow-lg hover:shadow-2xl transition-all duration-500 p-3 sm:p-4 border border-lime-200/50 dark:border-lime-700/50 hover:border-lime-400 dark:hover:border-lime-500 hover:scale-105 transform min-h-[100px]">
        <div class="absolute inset-0 bg-gradient-to-br from-lime-400 to-green-500 opacity-0 group-hover:opacity-20 transition-all duration-500"></div>
        <div class="absolute -top-10 -right-10 w-20 h-20 bg-lime-400 rounded-full opacity-10 group-hover:opacity-20 group-hover:scale-110 transition-all duration-500"></div>
        <div class="relative z-10">
          <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100 mb-2 group-hover:text-lime-600 dark:group-hover:text-lime-400 transition-colors">Noise Field Sculpture</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm leading-relaxed">Perlinノイズによる地形等高線</p>
          <div class="mt-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
            <span class="inline-block w-2 h-2 bg-lime-400 rounded-full animate-pulse"></span>
            <span class="text-xs text-lime-600 dark:text-lime-400 ml-2 font-mono">Interactive</span>
          </div>
        </div>
      </button>

      <button onclick="loadSketch('mandelbrot')" class="group relative overflow-hidden rounded-2xl bg-white/70 dark:bg-gray-800/70 backdrop-blur-md shadow-lg hover:shadow-2xl transition-all duration-500 p-3 sm:p-4 border border-indigo-200/50 dark:border-indigo-700/50 hover:border-indigo-400 dark:hover:border-indigo-500 hover:scale-105 transform min-h-[100px]">
        <div class="absolute inset-0 bg-gradient-to-br from-indigo-400 to-blue-500 opacity-0 group-hover:opacity-20 transition-all duration-500"></div>
        <div class="absolute -top-10 -right-10 w-20 h-20 bg-indigo-400 rounded-full opacity-10 group-hover:opacity-20 group-hover:scale-110 transition-all duration-500"></div>
        <div class="relative z-10">
          <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100 mb-2 group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors">Mandelbrot集合</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm leading-relaxed">複素数平面上の美しいフラクタル</p>
          <div class="mt-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
            <span class="inline-block w-2 h-2 bg-indigo-400 rounded-full animate-pulse"></span>
            <span class="text-xs text-indigo-600 dark:text-indigo-400 ml-2 font-mono">Interactive</span>
          </div>
        </div>
      </button>

      <button onclick="loadSketch('ornstein_uhlenbeck')" class="group relative overflow-hidden rounded-2xl bg-white/70 dark:bg-gray-800/70 backdrop-blur-md shadow-lg hover:shadow-2xl transition-all duration-500 p-3 sm:p-4 border border-rose-200/50 dark:border-rose-700/50 hover:border-rose-400 dark:hover:border-rose-500 hover:scale-105 transform min-h-[100px]">
        <div class="absolute inset-0 bg-gradient-to-br from-rose-400 to-red-500 opacity-0 group-hover:opacity-20 transition-all duration-500"></div>
        <div class="absolute -top-10 -right-10 w-20 h-20 bg-rose-400 rounded-full opacity-10 group-hover:opacity-20 group-hover:scale-110 transition-all duration-500"></div>
        <div class="relative z-10">
          <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100 mb-2 group-hover:text-rose-600 dark:group-hover:text-rose-400 transition-colors">Ornstein-Uhlenbeck過程</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm leading-relaxed">確率微分方程式による軌道の可視化</p>
          <div class="mt-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
            <span class="inline-block w-2 h-2 bg-rose-400 rounded-full animate-pulse"></span>
            <span class="text-xs text-rose-600 dark:text-rose-400 ml-2 font-mono">Interactive</span>
          </div>
        </div>
      </button>

      <button onclick="loadSketch('gray_scott')" class="group relative overflow-hidden rounded-2xl bg-white/70 dark:bg-gray-800/70 backdrop-blur-md shadow-lg hover:shadow-2xl transition-all duration-500 p-3 sm:p-4 border border-teal-200/50 dark:border-teal-700/50 hover:border-teal-400 dark:hover:border-teal-500 hover:scale-105 transform min-h-[100px]">
        <div class="absolute inset-0 bg-gradient-to-br from-teal-400 to-green-500 opacity-0 group-hover:opacity-20 transition-all duration-500"></div>
        <div class="absolute -top-10 -right-10 w-20 h-20 bg-teal-400 rounded-full opacity-10 group-hover:opacity-20 group-hover:scale-110 transition-all duration-500"></div>
        <div class="relative z-10">
          <h3 class="text-xl font-semibold text-gray-800 dark:text-gray-100 mb-2 group-hover:text-teal-600 dark:group-hover:text-teal-400 transition-colors">Gray-Scott系</h3>
          <p class="text-gray-600 dark:text-gray-400 text-sm leading-relaxed">反応拡散系による自己組織化パターン</p>
          <div class="mt-3 opacity-0 group-hover:opacity-100 transition-opacity duration-300">
            <span class="inline-block w-2 h-2 bg-teal-400 rounded-full animate-pulse"></span>
            <span class="text-xs text-teal-600 dark:text-teal-400 ml-2 font-mono">Interactive</span>
          </div>
        </div>
          </button>
        </div>
      </div>

      <!-- Center Column: Canvas -->
      <div class="center-content">
        <div class="canvas-container">
          <div class="canvas-bg"></div>
          <div id="canvas-container" class="canvas-content"></div>
        </div>
        
        <!-- Info Panel -->
        <div class="info-panel">
          <div class="panel-content">
            <div class="panel-icon">
              <svg class="w-4 h-4 text-white" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"></path>
              </svg>
            </div>
            <div class="panel-text">
              <h4 class="panel-title">操作方法</h4>
              <p id="sketch-info" class="panel-desc">作品を選択すると操作方法が表示されます</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Column: Parameters -->
      <div class="right-sidebar">
        <h2 class="sidebar-title">パラメータ調整</h2>
        <div id="parameters-panel" class="parameters-container">
          <div id="parameters-content" class="parameters-content">
            <p class="empty-state">作品を選択するとパラメータが表示されます</p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script src="sketch.js"></script>
  
  <script>
    // Dark mode toggle
    function toggleDarkMode() {
      document.documentElement.classList.toggle('dark');
      localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
    }

    // Check for saved dark mode preference
    if (localStorage.getItem('darkMode') === 'true' || 
        (!localStorage.getItem('darkMode') && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
      document.documentElement.classList.add('dark');
    }

    // Enhanced loadSketch function
    function loadSketch(sketchName) {
      changeMode(sketchName);
      updateInfo(sketchName);
      updateActiveButton(sketchName);
      showParameters(sketchName);
    }

    // Update active button styling
    function updateActiveButton(sketchName) {
      const buttons = document.querySelectorAll('button[onclick^="loadSketch"]');
      buttons.forEach(button => {
        if (button.getAttribute('onclick').includes(sketchName)) {
          button.classList.add('ring-2', 'ring-offset-2', 'ring-gray-400', 'dark:ring-gray-600');
        } else {
          button.classList.remove('ring-2', 'ring-offset-2', 'ring-gray-400', 'dark:ring-gray-600');
        }
      });
    }

    // Update info text
    function updateInfo(sketchName) {
      const infoText = {
        'flow_field': 'マウスクリックで新しいパーティクルを追加できます',
        'wave_interference': 'マウスクリックで波源を移動、スペースキーで再配置、Rキーでパラメータ変更',
        'recursive_tree': 'マウスを動かして木の形を変更、スペースキーで再描画、Sキーで画像保存',
        'harmonic_waves': 'マウス位置で周波数と位相を調整、Rキーでリセット、Sキーで画像保存',
        'polar_rose': 'マウス位置でバラの形を変更、Rキーでリセット、Sキーで画像保存',
        'noise_field_sculpture': 'マウスで地形の詳細度と等高線数を調整、Rキーでリセット、Sキーで画像保存',
        'mandelbrot': 'マウスクリックでズーム、Rキーでリセット、Sキーで画像保存',
        'ornstein_uhlenbeck': 'マウス位置でパラメータ調整、Rキーでリセット、Sキーで画像保存',
        'gray_scott': 'マウスクリックで新しい種を追加、Rキーでリセット、Sキーで画像保存'
      };
      document.getElementById('sketch-info').textContent = infoText[sketchName] || '';
    }

    // Show parameters panel
    function showParameters(sketchName) {
      const content = document.getElementById('parameters-content');
      
      // Clear previous content
      content.innerHTML = '';
      
      if (sketchName === 'flow_field') {
        content.innerHTML = `
          <div class="parameter-control">
            <label class="parameter-label">
              ノイズスケール: <span id="noise-value" class="parameter-value">${noiseScale}</span>
            </label>
            <input type="range" min="0.001" max="0.1" step="0.001" value="${noiseScale}" 
                   onchange="noiseScale = parseFloat(this.value); document.getElementById('noise-value').textContent = this.value"
                   class="parameter-slider">
          </div>
          <div class="parameter-control">
            <label class="parameter-label">
              最大速度: <span id="speed-value" class="parameter-value">2</span>
            </label>
            <input type="range" min="0.5" max="5" step="0.1" value="2" 
                   onchange="particles.forEach(p => p.maxSpeed = parseFloat(this.value)); document.getElementById('speed-value').textContent = this.value"
                   class="parameter-slider">
          </div>
        `;
      } else if (sketchName === 'wave_interference') {
        content.innerHTML = `
          <div class="parameter-control">
            <label class="parameter-label">波の数: ${numWaves}</label>
            <p class="panel-desc">Rキーを押してパラメータをランダム化</p>
          </div>
        `;
      } else if (sketchName === 'recursive_tree') {
        content.innerHTML = `
          <div class="parameter-control">
            <label class="parameter-label">枝の角度</label>
            <p class="panel-desc">マウスのX座標で調整</p>
          </div>
          <div class="parameter-control">
            <label class="parameter-label">枝の長さ比</label>
            <p class="panel-desc">マウスのY座標で調整</p>
          </div>
        `;
      } else if (sketchName === 'mandelbrot') {
        content.innerHTML = `
          <div class="parameter-control">
            <label class="parameter-label">複素数平面の探索</label>
            <p class="panel-desc">クリックして興味深い領域にズーム</p>
          </div>
        `;
      } else if (sketchName === 'ornstein_uhlenbeck') {
        content.innerHTML = `
          <div class="parameter-control">
            <label class="parameter-label">回帰速度θ</label>
            <p class="panel-desc">マウスのX座標で調整</p>
          </div>
          <div class="parameter-control">
            <label class="parameter-label">ノイズ強度σ</label>
            <p class="panel-desc">マウスのY座標で調整</p>
          </div>
        `;
      } else if (sketchName === 'harmonic_waves') {
        content.innerHTML = `
          <div class="parameter-control">
            <label class="parameter-label">周波数X</label>
            <p class="panel-desc">マウスのX座標で調整</p>
          </div>
          <div class="parameter-control">
            <label class="parameter-label">周波数Y</label>
            <p class="panel-desc">マウスのY座標で調整</p>
          </div>
        `;
      } else if (sketchName === 'polar_rose') {
        content.innerHTML = `
          <div class="parameter-control">
            <label class="parameter-label">花びらの数</label>
            <p class="panel-desc">マウスのX座標で調整</p>
          </div>
          <div class="parameter-control">
            <label class="parameter-label">回転速度</label>
            <p class="panel-desc">マウスのY座標で調整</p>
          </div>
        `;
      } else if (sketchName === 'noise_field_sculpture') {
        content.innerHTML = `
          <div class="parameter-control">
            <label class="parameter-label">地形の詳細度</label>
            <p class="panel-desc">マウスのX座標で調整（左=広域、右=詳細）</p>
          </div>
          <div class="parameter-control">
            <label class="parameter-label">等高線の数</label>
            <p class="panel-desc">マウスのY座標で調整</p>
          </div>
        `;
      } else if (sketchName === 'gray_scott') {
        content.innerHTML = `
          <div class="parameter-control">
            <label class="parameter-label">反応拡散パターン</label>
            <p class="panel-desc">クリックして新しい反応核を追加</p>
          </div>
        `;
      } else {
        content.innerHTML = '<p class="empty-state">作品を選択するとパラメータが表示されます</p>';
      }
    }

    // Initialize with first sketch on load
    window.addEventListener('DOMContentLoaded', () => {
      setTimeout(() => {
        loadSketch('flow_field');
      }, 50);
    });
  </script>
</body>
</html>